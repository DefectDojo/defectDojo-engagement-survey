{% extends "base.html" %}
{% block content %}
    <div class="row">
        <div class="col-md-10">
            {% if surveys %}
                <div class="panel panel-default table-responsive">
                    <table class="tablesorter-bootstrap table table-bordered table-condensed table-striped table-hover">
                        <thead>
                        <tr>
                            <th>Name</th>
                            <th>Question Count</th>
                            <th>Active</th>
                        </tr>
                        </thead>
                        <tbody>
                        {% for survey in surveys %}
                            <tr>
                                <td><a title="{{ survey.name }}"
                                                      href="{% url 'edit_survey' survey.id %}">{{ survey.name }}</a>
                                </td>
                                <td class="nowrap">{{ survey.questions.all|length }}</td>
                                <td>{{ survey.active }}</td>
                            </tr>
                        {% endfor %}
                        </tbody>
                    </table>
                </div>
                {% include "dojo/paging_snippet.html" with page=surveys %}
            {% else %}
                No surveys found.
            {% endif %}
        </div>
        <div class="col-md-2">
            <div class="panel panel-default filters">
                {% if filtered.form %}
                    {% if request.user.is_staff %}
                        <div class="panel-heading">Actions</div>
                        <div class="panel-body centered">
                            <a class="btn btn-sm btn-primary" href="{% url 'create_survey' %}">
                                Create Survey
                            </a>
                        </div>
                    {% endif %}
                    <div class="panel-heading">Filters</div>
                    <form method="get" class="panel-body">
                        {{ filtered.form.as_p }}
                        <div class="centered">
                            <input type="submit" class="btn btn-primary inline top" value="Apply"/><br/><br/>
                            <a href="{% url 'survey' %}"> [Clear Filters] </a>
                        </div>
                    </form>
                {% endif %}
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-lg-12">
            <div class="panel panel-default">
                <div class="panel-heading">
                    Unanswered Engagement Surveys
                    <a title="Add Survey" class="pull-right btn btn-sm btn-primary" href="/empty_survey"><span class="fa fa-plus"></span></a>
                </div>
                <div class="panel-body">
                    {% if empty %}
                        <table id="empty" class="tablesorter-bootstrap table table-condensed table-striped">
                            <thead>
                            <tr>
                                <th>Name</th>
                                <th>Product</th>
                                <th>Engagement</th>
                                <th>Responder</th>
                                <th>Status</th>
                                <th>Completion Date</th>
                                <th>Actions</th>
                            </tr>
                            </thead>
                            {% for survey in empty %}
                                <tr>
                                    <td><a href="/engagement/{{ survey.engagement.id }}/survey/{{ survey.id }}">{{ survey.survey.name }}</a></td> 
                                    <td><a href="/product/{{ survey.engagement.prod_id }}">{{ survey.engagement.product.name }}</a>
                                    <td><a href="/engagement/{{ survey.engagement.id }}">{{ survey.engagement.name }}</a> 
                                    <td>{{ survey.responder }}</td>
                                    <td>
                                        {% if survey.completed %}
                                            <span class="pass_fail Pass">Completed</span>
                                        {% else %}
                                            <span class="pass_fail">Unanswered</span>
                                        {% endif %}
                                    </td>
                                    <td>{{ survey.answered_on }}</td>
                                    <td>
                                        <div class="btn-group">
                                            <a class="btn btn-sm btn-success"
                                            href="/empty_survey/{{ survey.id }}/answer"> Answer</a>
                s                            <button type="button" class="btn btn-sm btn-primary" data-toggle="modal"
                                                    data-target="#shareSurveyModal"
                                                    data-whatever="/empty_survey/{{ survey.id }}/answer">
                                                <i class="fa fa-share-alt"></i> Share Survey
                                            </button>
                                            <a class="btn btn-sm btn-danger"
                                            href="empty_survey/{{ survey.id }}/delete"> Delete
                                                Survey </a>
                                        </div>
                                    </td>
                                </tr>
                            {% endfor %}
                        </table>
                    {% else %}
                        <div class="panel-body">
                            <p>No surveys found.</p>
                        </div>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
{% endblock %}
